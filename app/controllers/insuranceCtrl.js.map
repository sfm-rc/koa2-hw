{"version":3,"sources":["../../src/controllers/insuranceCtrl.js"],"names":[],"mappings":"uSAAA;AACA,iC;;AAEA;;;;;AAKA,IAAM,uGAAM,iBAAM,GAAN,EAAW,IAAX;AACF,8BADE,GACO,IAAI,OAAJ,CAAY,IADnB;AAED,mCAFC,GAE4F,MAF5F,CAED,WAFC,EAEY,SAFZ,GAE4F,MAF5F,CAEY,SAFZ,EAEuB,QAFvB,GAE4F,MAF5F,CAEuB,QAFvB,EAEiC,MAFjC,GAE4F,MAF5F,CAEiC,MAFjC,EAEyC,GAFzC,GAE4F,MAF5F,CAEyC,GAFzC,EAE8C,KAF9C,GAE4F,MAF5F,CAE8C,KAF9C,EAEqD,MAFrD,GAE4F,MAF5F,CAEqD,MAFrD,EAE6D,SAF7D,GAE4F,MAF5F,CAE6D,SAF7D,EAEwE,gBAFxE,GAE4F,MAF5F,CAEwE,gBAFxE;;AAIF,gCAJE,uDAI0D,WAJ1D,wBAIsF,MAJtF;AAKgB,sDAAM,QAAN,CALhB,SAKF,SALE;AAML,kCAAU,MAAV,GAAiB,CANZ;AAON,4BAAI,IAAJ,GAAW,EAAC,MAAM,CAAP,EAAU,SAAQ,QAAlB,EAA4B,oBAA5B,EAAX,CAPM;;;;;AAYA,2BAZA;AAaY,mCAbZ,aAa6B,SAb7B,cAa6C,QAb7C,cAa4D,MAb5D,cAayE,GAbzE,cAamF,KAbnF,cAa+F,MAb/F;AAcO,iCAdP,cAcuB,gBAdvB,cAc8C,+BAd9C;;AAgBW,sDAAM,GAAN,CAhBX,UAgBF,IAhBE;AAiBN,gCAAQ,GAAR,CAAY,sBAAZ,EAAoC,IAApC;AACA,4BAAI,IAAJ,GAAW,EAAC,MAAM,CAAP,EAAU,SAAQ,QAAlB,EAA4B,UAA5B,EAAX,CAlBM,oEAAN,yEAAN,C;;;;;AAuBe;AACX,YADW,E","file":"insuranceCtrl.js","sourcesContent":["import {query} from '../models/db_connection';\r\nimport { pagination, getLinuxTimeStamp} from '../uitil';\r\n\r\n/**\r\n * 填写保险\r\n * @param {*} ctx \r\n * @param {*} next \r\n */\r\nconst add = async(ctx, next) => {\r\n    const params = ctx.request.body;\r\n    const {activity_id, user_name, cer_type, cer_id, sex, birth, mobile, e_contact, e_contact_mobile} = params;\r\n\r\n    const exit_sql = `select * from hw_insurance where activity_id='${activity_id}' and cer_id='${cer_id}'`;\r\n    const exit_data = await query(exit_sql);\r\n    if(exit_data.length>0){\r\n      ctx.body = {code: 1, message:'保单已经填写', exit_data}\r\n      return;\r\n    }\r\n    else {\r\n\r\n      const sql = `INSERT into hw_insurance VALUES(\r\n                NULL,'${activity_id}','${user_name}', '${cer_type}', '${cer_id}', '${sex}', '${birth}', '${mobile}', \r\n                '${e_contact}', '${e_contact_mobile}', '${getLinuxTimeStamp()}'\r\n            )`;\r\n      var data = await query(sql);\r\n      console.log('insert hw_insurance:', data);\r\n      ctx.body = {code: 0, message:'保单填写成功', data}\r\n    }\r\n}\r\n\r\n\r\nexport default {\r\n    add,\r\n}"]}